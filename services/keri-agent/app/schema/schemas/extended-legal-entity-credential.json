{
  "$id": "EPknTwPpSZi379molapnuN4V5AyhCxz_6TLYdiVNWvbV",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Extended Legal Entity vLEI Credential",
  "description": "Legal Entity credential with explicit incorporation country field and required certification edge. Per the VVP Multichannel Vetters spec, each identity credential must contain a backlink to the vetter's certification for jurisdictional constraint validation.",
  "type": "object",
  "credentialType": "ExtendedLegalEntityvLEICredential",
  "version": "1.0.0",
  "properties": {
    "v": {
      "description": "Version",
      "type": "string"
    },
    "d": {
      "description": "Credential SAID",
      "type": "string"
    },
    "u": {
      "description": "One time use nonce",
      "type": "string"
    },
    "i": {
      "description": "QVI Issuer AID",
      "type": "string"
    },
    "ri": {
      "description": "Credential status registry",
      "type": "string"
    },
    "s": {
      "description": "Schema SAID",
      "type": "string"
    },
    "a": {
      "oneOf": [
        {
          "description": "Attributes block SAID",
          "type": "string"
        },
        {
          "$id": "",
          "description": "Attributes block",
          "type": "object",
          "properties": {
            "d": {
              "description": "Attributes block SAID",
              "type": "string"
            },
            "i": {
              "description": "LE Issuer AID (issuee)",
              "type": "string"
            },
            "dt": {
              "description": "Issuance date time",
              "type": "string",
              "format": "date-time"
            },
            "LEI": {
              "description": "Legal Entity Identifier",
              "type": "string",
              "format": "ISO 17442"
            },
            "country": {
              "description": "ISO 3166-1 alpha-3 incorporation country code (e.g., GBR, FRA, USA). Required for jurisdictional constraint validation per VVP Multichannel Vetters spec.",
              "type": "string",
              "pattern": "^[A-Z]{3}$"
            },
            "legalName": {
              "description": "Legal name of the entity",
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [
            "i",
            "dt",
            "LEI",
            "country"
          ]
        }
      ]
    },
    "e": {
      "oneOf": [
        {
          "description": "Edges block SAID",
          "type": "string"
        },
        {
          "$id": "",
          "description": "Edges block",
          "type": "object",
          "properties": {
            "d": {
              "description": "Edges block SAID",
              "type": "string"
            },
            "qvi": {
              "description": "QVI node - link to Qualified vLEI Issuer credential",
              "type": "object",
              "properties": {
                "n": {
                  "description": "Issuer credential SAID",
                  "type": "string"
                },
                "s": {
                  "description": "SAID of required schema of the credential pointed to by this node",
                  "type": "string",
                  "const": "EBfdlu8R27Fbx-ehrqwImnK-8Cm79sqbAQ4MmvEAYqao"
                }
              },
              "additionalProperties": false,
              "required": [
                "n",
                "s"
              ]
            },
            "certification": {
              "description": "REQUIRED: Backlink to the issuing vetter's Vetter Certification credential. Per the VVP Multichannel Vetters spec, this edge enables verification that the vetter is authorized to issue identity credentials for the entity's incorporation jurisdiction.",
              "type": "object",
              "required": [
                "n",
                "s"
              ],
              "properties": {
                "n": {
                  "description": "SAID of the vetter's Vetter Certification credential",
                  "type": "string"
                },
                "s": {
                  "description": "SAID of the Vetter Certification schema",
                  "type": "string"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false,
          "required": [
            "d",
            "qvi",
            "certification"
          ]
        }
      ]
    },
    "r": {
      "oneOf": [
        {
          "description": "Rules block SAID",
          "type": "string"
        },
        {
          "$id": "",
          "description": "Rules block",
          "type": "object",
          "properties": {
            "d": {
              "description": "Rules block SAID",
              "type": "string"
            },
            "usageDisclaimer": {
              "description": "Usage Disclaimer",
              "type": "object",
              "properties": {
                "l": {
                  "description": "Associated legal language",
                  "type": "string",
                  "const": "Usage of a valid, unexpired, and non-revoked vLEI Credential, as defined in the associated Ecosystem Governance Framework, does not assert that the Legal Entity is trustworthy, honest, reputable in its business dealings, safe to do business with, or compliant with any laws or that an implied or expressly intended purpose will be fulfilled."
                }
              }
            },
            "issuanceDisclaimer": {
              "description": "Issuance Disclaimer",
              "type": "object",
              "properties": {
                "l": {
                  "description": "Associated legal language",
                  "type": "string",
                  "const": "All information in a valid, unexpired, and non-revoked vLEI Credential, as defined in the associated Ecosystem Governance Framework, is accurate as of the date the validation process was complete. The vLEI Credential has been issued to the legal entity or person named in the vLEI Credential as the subject; and the qualified vLEI Issuer exercised reasonable care to perform the validation process set forth in the vLEI Ecosystem Governance Framework."
                }
              }
            }
          },
          "additionalProperties": false,
          "required": [
            "d",
            "usageDisclaimer",
            "issuanceDisclaimer"
          ]
        }
      ]
    }
  },
  "additionalProperties": false,
  "required": [
    "i",
    "ri",
    "s",
    "d",
    "e",
    "r"
  ]
}